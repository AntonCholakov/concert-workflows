**for e2e testing, after importing the workflow, give inputJsonPayload as an empty dictonary {} and save the workflow. This will take values from pipeline otherwise it will take default value.
# Linux patch Workflow
Import the workflow inside `Remediation` folder in Concert Workflows

## Input to the workflow
  <img width="1071" alt="image" src="https://github.ibm.com/roja/concert-workflows/assets/470273/aa29267c-f289-47d4-af56-2b962ec549ce">

  Fill input_json_data with the sample data provided in this folder
  https://github.ibm.com/roja/concert-workflows/blob/Linux_patch_Vm/Vulnerability/Remediation/sample_data/Linux_patch_input_json_data.json
  


## Setup and Run workflow
* step 1: Set up Ansible authentication to the remote machines by creating the necessary authentication keys. Create a Config Data Auth and store these keys in the ConfigData Auth in JSON format.
Provide the name of this ConfigData Auth entry as input to the ConfigDataAuth field in the workflow.
   
  <img width="551" alt="image" src="https://github.ibm.com/roja/concert-workflows/assets/470273/df6677fe-f084-44fd-aad8-67a3cc7982ae">

  1.**sample structure of ConfigData**

        {
       "config" :[
       {
       "auth": "ibmconcert@0000-0000-0000-0000/linux_patch_auth1",
       "host": ["9.46.239.156"]
       },
       {
       "auth": "ibmconcert@0000-0000-0000-0000/linux_patch_auth2",
       "host": ["9.30.123","9.12.34.5"]
       }
       ]
       }

    Here auth "_ibmconcert@0000-0000-0000-0000/linux_patch_auth2_" includes two host machines , so provided ip_adresses for the same in the host field.

  2.**Ansible Auth details-** eg-Multiple hosts under same auth
       <img width="557" alt="image" src="https://github.ibm.com/roja/concert-workflows/assets/470273/c32706a1-77a6-43f4-b9d0-be2ee2d2d05c">


         Private Key:

           {"redhat-patch.b64":"base64 encode value of the private-key(id_rsa)",
            "linux-test.b64":"base64 encode value of the private-key(id_rsa)"}

         Use the below command to generate Base64 encode value of id_rsa -
         base64 -w 0 ~/.ssh/id_rsa
  
         Inventory:

            [canary]
            9.46.239.156 ansible_host=redhat-linux-patch1.fyre.ibm.com ansible_user=root ansible_ssh_private_key_file=redhat-patch.b64
            9.30.123.9 ansible_host=linux-patch-test1.fyre.ibm.com ansible_user=root ansible_ssh_private_key_file=linux-test.b64

        Below Structure should follow under Inventory to define the canary machines
    
          **<ip_adress> ansible_host=<machine host name> ansible_user=<user> ansible_ssh_private_key_file=<respective filename provided in the Private key>**

        _Note:_ ansible_ssh_private_key_file value in the inventory should match with the key name in the Private Key JSON.

* step 2: Provide rest of the inputs as shown in the screenshot




# Tomcat Workflow
Import the workflow inside `Remediation` folder in Concert Workflows

## Input to the workflow
<img width="1274" alt="Screenshot 2025-03-17 at 12 45 39 PM" src="https://github.ibm.com/roja/concert-workflows/assets/441987/78cf0f16-2719-4fd4-917f-0ec9514f0179">
If you are running this workflow standalone fill input_json_data with the sample data provided in this folder https://github.ibm.com/roja/concert-workflows/Vulnerability/Remediation/sample_data/tomcat_input_data.json

## Setup tomcat 

### Follow the below commands to install tomcat (v9.0.68) to your /opt folder
`sudo yum install -y java-11-openjdk wget unzip`
`cd /opt`
`wget https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.68/bin/apache-tomcat-9.0.68.tar.gz`
`tar -xvzf apache-tomcat-9.0.68.tar.gz`
`mv apache-tomcat-9.0.68 tomcat`
`sudo chmod +x /opt/tomcat/bin/*.sh`
`/opt/tomcat/bin/startup.sh`
`ps aux | grep tomcat`

### Follow bellow commands to create below mandatory folders
tomcat_backup and tomcat_tobe folders are expected to be in your cd /opt folder
cd /opt
`mkdir tomcat_backup`
`mkdir tomcat_tobe`

### Follow bellow commands to to install tomcat (v9.0.98) to your tomcat_tobe folder
tar file of tomcat version to be installed is expected to be present in the folder tomcat_tobe
`cd tomcat_tobe`
`wget https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.98/bin/apache-tomcat-9.0.98.tar.gz`

## Setup and Run workflow
* step 1: create ansible authentication to the tomcat machine and provide the auth key in the input variable "auth" as shown in the screenshot
* step 2: Provide rest of the inputs as shown in the screenshot
* step 3: You can use this command to find host ip of your tomcat machine `ip route get 1.2.3.4 | awk '{print $7}'`
* step 4: Save and run the workflow


# PR Workflows
Import the workflow inside `Remediation` folder in Concert Workflows

## Docker Base Image Upgarde and pom.xml Upgrade Workflow

### Create github authentication
* go to workflows >> Authentications >> Create Authentication
* Give a name (eg: git-token)
* Select Github from service
* Give your github token in the field Access Token
* Give `https://api.github.ibm.com` in Domain
* Create your auth token
Use this authKey in your PR workflow gitToken field

### Create api key authentication
* go to workflows >> Authentications >> Create Authentication
* Give a name (eg: api-auth)
* Select API from service
* give `Authorization` as header and your concert auth key including C_API part in key
* Create your auth token
Use this authKey in your PR workflow apiAuth field

## Input to the Workflow
Input details to be provided
repo details: org, repo, assignee, owner, email, date DD-MM-YYYY
Auth details: gitToken, apiAuth, instanceId, host (concert host name) and  port 
* If your are invoking the workflow as standalone use the sample input_data.json provided in the `sample_data` sub directory. Change repo_name, org_name, repo_url etc in the metadata of the sample input_data.json according to the files. 

## Setup and Run workflow
After setting up the input variables and auth correctly, save and run the workflow

# Scan Workflow
Import the workflow inside `Discovery` folder in Concert Workflows
## Create Authentication
* Step 1: Create Ansible authentication to the test machine
* Step 2: Create SSH authentication to the test machine
* Step 3: Provide these two authKeys in the input field along with the ConcertAPIKey auth
  
Follow the steps here [Scan Workflow guide.docx](https://github.ibm.com/roja/concert-workflows/files/1504967/Scan.Workflow.guide.docx)
. Python script for conversion to Concert Supported VM scan format is available with in `Scripts` folder in this repository 

# Get_CVEs_from_last_sync_ts Workflow
## Inputs to the workflow
- `concert_host`: Target concert host (eg: vmtest1.fyre.ib.com)
- `instance_id`: Instance ID
- `port`: Port number.
- `c_api_key`: Create an API Key Authentication(not Concert API Key Authentication) and pass the url here (eg: ibmconcert/c_api_key_test)

>*Note: If we need to test with specific CVEs, change the `nvd_query_args` variable in `Initialise_query_args` assignment block with the following data.*
>```json
>{
>    "cveId": "<YOUR_CVE_ID>"
>}
>```

# AWS EKS UPGRADE Workflow
>This workflow supports **only Amazon EKS clusters with managed node groups**.
Import from automation library 
## Prerequisites 
* You have the required access to update the EKS cluster and its node groups. 
* The application running on the EKS cluster is scaled down to avoid disruptions during the upgrade. 
* AWS CLI installed and configured on a virtual machine (VM).

    ```bash
    curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
    unzip awscliv2.zip
    sudo ./aws/install
    aws --version

    aws configure
    ```
    
    Provide the following when prompted:  
    - AWS Access Key ID  
    - AWS Secret Access Key  
    - Default Region (e.g., us-east-1)  
    - Default Output Format (e.g., json)  

## Create Authentication 
* To create Ansible authentication to your vm, refer abouve workflows
* Create Amazon Web Services authentication to your cluster with your **access key id** and **secret key**

##  Input to workflow 
Input details to be provided in the main workflow
cluster details: Cluster name , AWS Region ,Target Kubernetes version 
Auth details: ansible authentication , aws authentication 

<img width="1016" alt="Screenshot 2025-06-03 at 5 43 41 PM" src="https://github.ibm.com/roja/concert-workflows/assets/443693/de2d74ae-53e9-4793-acd7-6554e60a7553">


## Setup and Run workflow
Scale down the applications running in the cluster. 
```bash 
oc scale deployment --all --replicas=0 -n <namespace> 
oc scale statefulset --all --replicas=0 -n <namespace> 
```

After setting up the input variables and auth correctly, save and run the main workflow.
After running the wf successfully you can see the below output:

![image (8)](https://github.ibm.com/roja/concert-workflows/assets/443693/7a65f92a-623f-41e2-9fff-2c1392ff7d44)

scale up and test your application 


# Remediation Flow
When the Scan reports for VM or image are ingested to concert and the assessment is completed, Concert might discover the patches which can be used to remediation the Vulnerabilities. On discovering the patches, concert generates the actions. Then workflow can be used to raise the PR for the actions which requires code change. Or it can raise Service Now incident (or it can Change request in any user preference tool). Once the service now incident is raised, user can go there an approve the actions. Once the action is approved, patch workflow is scheduled and VM patching is done based on the schedule. Following workflow can be used for the same.

## Create_Change_Request_For_Remediation_Action 
This workflow pulls the new actions for Vulnerabilities which can be auto remediated. Once it has the list of actions, for the actions which requires pull request to be raised, it raises the pull_request based on the sub type. For the actions which required OS patching and webserver upgrade, it raises the Service Now incident. Once the PR and Incident is raised respectively, It updates the actions status to approval awaiting and sets the maintenance_windows based on the inputs. After this step, CR and PR links can be accessed in Actions details page.

This workflow takes the following inputs:
* concert_auth: Workflow authentication of type **IBM Hub - Self**
   <img width="551" alt="image" src="https://github.ibm.com/roja/concert-workflows/assets/489467/ee66d673-e1cf-4c1a-9772-064294ebeba3">
* sm_auth: Authentication for service management tool like Service Now. Create workflow authentication of type **ServiceNow** and pass the value here as show in the blow screenshot.
* caller: User's name for Service management tool
* sm_host: Full instance URL of Service Now instance
* assignee: User name for raising PR in Git
* email: Email for raising PR in Git for pull request actions
* git_auth: Workflow authentication of type Github with access to git repos


Additionally following variable can be provided:
* group_by: One of target_component_identifier, app_release_id, actions_identifier, application_name. It will group the actions based on the context provided and raise one service now incident for the same
* maintenance_window: Provide application name with the schedule time for patching. If no provided, patch maintenance window is set for next day.


![image](https://github.ibm.com/roja/concert-workflows/assets/489467/2e79b2bf-76dd-441a-ba1d-f077e7c47f8d)

We can run the workflow by passing the input variables or schedule a job to run it in regular intervals. The workflow will fetch the actions which are in created status, create PR or a service-now incident and move the status to approval_awaiting.

## Monitor_Remediation_Action_Status
This workflows pull the actions of type OS and web server which are in approval awaiting state for which Service Now incident in the by the first workflow. User can go to the Service Now Incident and update the status as In progress if want to proceed with patching. If user does not want to patch the VM, then update the state as Cancelled.
When this workflow is run, it checks the service now incident state and update the Actions status in Concert accordingly. If the user approves the incident i.e moves it to In progress, The patch workflow is scheduled.
This workflow takes the following inputs:
* sm_auth: Authentication for service management tool like Service Now. Create workflow authentication of type **ServiceNow** and pass the value here as show in the blow screenshot.
* workflow_auth: It will be the Pliant authentication. Create workflow authentication of type ** IBM Hub - Self (Workflows)** as shown.

  <img width="551" alt="image" src="https://github.ibm.com/roja/concert-workflows/assets/489467/9de5d0b3-d8fc-4a39-b260-fc640bd0b922">

* wf_to_schedule: It will be the path to the workflow we are planning to schedule. example 'workflow_user/User/Remediations/Remediation_Master'; workflow_user is the user and Remediation_Master is the workflow name and it is inside the Remediations folder.
Additionally following variable can be provided:
* group_by: One of target_component_identifier, app_release_id, actions_identifier, application_name. It will group the actions based on the context provided and raise one service now incident for the same
* concert_auth: Workflow authentication of type **IBM Hub - Self**
   <img width="551" alt="image" src="https://github.ibm.com/roja/concert-workflows/assets/489467/ee66d673-e1cf-4c1a-9772-064294ebeba3">
* workflow_user: Username of the workflow
  
![image](https://github.ibm.com/roja/concert-workflows/assets/489467/12ce2ff5-0029-401a-b16e-9fd27e88c652)

We can run the workflow by passing the input variables or schedule a job to run it in regular intervals. The workflow will fetch the actions which are in approval_awaiting status, check the status of the incident in service-now, and schedule the remediation workflow if the request is approved and update the action status. if the request is cancelled in service-now, will move the actions to failed.

## Remediation_Master
This workflow patches the VM or upgrades the webserver based on the OS flavor.
Import the required sub-workflows.
Click the three dots → Expose each sub-workflow.
Do not enable asynchronous execution — these workflows run synchronously.
Use the default workflow URI.
If changed, update it in the input as well.

here:

  <img width="550" alt="Screenshot 2025-07-25 at 3 23 00 PM" src="https://github.ibm.com/roja/concert-workflows/assets/489467/f530195c-7b19-4481-addb-347e79462706">


* concert_auth: Workflow authentication of type **IBM Hub - Self**
* sm_auth: Authentication for service management tool like Service Now. Create workflow authentication of type **ServiceNow** and pass the value here as show in the blow screenshot.
* linux_auth: Provide Linux auth as created as per [this](#setup-and-run-workflow).
* tomcat_auth: Provide VM auth for tomcat upgrade
* windows_auth: Provide VM auth for windows VMs
* tomcat_host: tomcat host details

 ![image](https://github.ibm.com/roja/concert-workflows/assets/489467/350b4e7a-b123-49ed-815b-9bb0ece2307b)

This workflow is getting scheduled from the Monitor_Remediation_Action_Status workflow. Hence it will get triggered at the scheduled time, will fetch the actions in scheduled status, run the upgrade/patch based on the remediation type and update the status as per the execution result.

# Windows Patching on Air-Gapped Servers
> This workflow enables secure patching of air-gapped Windows servers by leveraging a mirror VM (with internet access) to fetch and store required KBs, which are then installed on the target air-gapped VM using Ansible automation.


## Prerequisites

> To patch Windows servers that do not have internet access, provision and configure the following three virtual machines (VMs) in the same VPC/subnet to enable secure and isolated communication.

---

## Required VMs

### 1. Air-Gapped Windows VM (Target Machine)

- **OS**: Supported Windows version (must support WinRM and WSUS/DISM-based updates)
- **Instance Type**: `t3.medium`
- **Storage**: 40 GB
- **Network Access**:
  - No Internet Access
  - RDP Access: Enabled
- **Outbound Rule**:
  - Protocol: TCP  
  - Port: 445  
  - Destination: Private IP of the Mirror VM
- **Required Ports**:
  - WinRM HTTP: 5985  
  - WinRM HTTPS: 5986

### Unsupported Versions

> Avoid using Windows versions that lack support for WinRM or WSUS/DISM. These typically include:

- Windows XP  
- Windows Vista  
- Windows 7 (pre-SP1 or without extended support)  
- Windows Server 2003 / 2008

**Recommended**: Windows 10/11, or Windows Server 2012 R2 and newer

---

### 2. Mirror Windows VM (KB Storage Host)

- **OS**: Same supported Windows versions as above
- **Instance Type**: `t3.medium`
- **Storage**: 500 GB (at minimum)  
  - Used for storing downloaded KB patches (each KB can be up to 5–6 GB)
- **Internet Access**: Enabled
- **Inbound Rule**:
  - Protocol: TCP  
  - Port: 445  
  - Source: Private IP of the Air-Gapped VM
- **Required Ports**:
  - WinRM HTTP: 5985  
  - WinRM HTTPS: 5986

---

### 3. Linux VM (Concert + Workflow)

- **OS**: Any supported Linux distribution compatible with Concert
- **Instance Specs**:
  - CPU: 16 vCPUs  
  - Memory: 32 GB RAM  
  - Disk: 250 GB

---

## Required: Windows App for RDP Access

> To access and manage the Windows VMs, you must install and use the Windows App from Microsoft:

[Download Windows App from Microsoft Store](https://apps.microsoft.com/detail/9n1f85v9t8bn?hl=en-GB&gl=IN)

This is essential because:

- RDP is the only way to log in and manage the Windows VMs
- The app provides a full desktop experience and better usability for patching and manual operations


# Authentication
## Create ansible authentication
> To get private key follow the below steps
```bash
# Use Powershell to execute below commands
# Step 1: Create .ssh directory
New-Item -ItemType Directory -Force -Path "$env:USERPROFILE\.ssh"

# Step 2: Generate RSA key pair
ssh-keygen -t rsa -b 4096 -f "$env:USERPROFILE\.ssh\id_rsa"

# Step 3: View your private key
Get-Content "$env:USERPROFILE\.ssh\id_rsa"
```

## Ansible inventory
```bash
  [windows]
  1.1.1.1  # Air-gapped Windows VM (public IP)

  [mirror]
  mirror_vm ansible_host=0.0.0.0  # Mirror VM (public IP)

  [mirror:vars]
  mirror_vm_private_ip=0.0.0.0  # Private IP of mirror VM (get via `ipconfig`)
  mirror_user=<mirror_vm_user>
  mirror_password=<mirror_vm_password>

  [windows:vars]
  ansible_user=<airgapped_vm_user>
  ansible_password=<airgapped_vm_password>
  ansible_connection=winrm # remains same
  ansible_port=<winrm_port> # http port: 5985, https port:5986
  ansible_winrm_transport=ntlm # remains same
  ansible_winrm_server_cert_validation=ignore # remains same

```

# Required inputs to run your workflow
- input_json: If you're testing this workflow manually (instead of triggering it through the pipeline), use the JSON structure in this path(/concert-workflows/Vulnerability/Remediation/sample_data/windows_patch_input_data.json)

   **Only update the KBnumber field, as it is the only value currently being used from the input json.**

- folder_path_to_store_kbs: Specify the full local path on the airgapped VM where the KB files will be copied to for installation (e.g., C:\Patches\KBs)

- shared_folder_name: Provide only the name of the shared folder (e.g., if the full path is C:\KBshare, enter just KBshare)
<img width="1718" alt="Screenshot 2025-06-30 at 2 39 27 PM" src="https://github.ibm.com/roja/concert-workflows/assets/481473/438b11f1-8c80-4e08-b421-b7cb1443a8ce">



## Identifying the Correct KB for Manual Workflow Testing

> When manually running  workflow for internal testing, it's important to select the correct KB, update that matches your Windows build. Below are a few recommended methods to help identify the right KB.

---

### Approach 1: Use Mirror and Air-Gapped VM with Same Windows Version

1. Make sure both your **Mirror VM** and **Air-Gapped VM** are running the same Windows version and build.
2. On the **Mirror VM** (which has internet access):
   - Open **Settings > Windows Update**
   - Click **"Check for updates"**
3. Note down the KBs that appear in the list.
4. Verify the KB exists on the [Microsoft Update Catalog](https://www.catalog.update.microsoft.com/Home.aspx).
5. Once verified, add the KB (e.g., `KB5034441`) to your input JSON for the workflow.

---

### Approach 2: Use Microsoft Security Update API (MSRC API)

1. Go to the [Microsoft Security Response Center (MSRC) CVE API](https://msrc.microsoft.com/update-guide/).
2. Search using your Windows version (e.g., `Windows Server 2019`).
3. Filter by KBs relevant to your build number(get via powershell. `systeminfo | Select-String "OS Version"` )
4. Pick the most recent KB that matches your system and add it to your input JSON.

---

## Run Workflow
> Ensure all authentication configurations and required inputs are provided before running the workflow.

## Verification

> This workflow will take approximately **10–15 minutes per KB** to complete.

If you want to manually verify whether a KB installation is happening or has completed successfully, you can use **Event Viewer**, which is the built-in logging system in Windows. It logs detailed events related to Windows Updates, including success, failure, and applicability status.

### How to Check via Event Viewer:

1. Open **Event Viewer**
2. Navigate to:  
   `Event Viewer > Windows Logs > Setup`
3. Look for entries related to **Windows Update** or the specific **KB number**

<img width="1149" alt="Screenshot 2025-06-30 at 2 40 19 PM" src="https://github.ibm.com/roja/concert-workflows/assets/481473/3cbc57ee-3265-4f1b-b3db-39524c527946">


## Reboot the System

> After patching, users must **manually reboot the system** to fully apply the KB updates.

While there is an event log entry that indicates whether a reboot is required, in some cases the **"Reboot Required"** event is delayed and only appears **after** the "Installed" event. This behavior occurs only for certain KBs, making it unreliable to depend solely on automation for reboot detection.

### Recommendation:

Always perform a **manual reboot after all patches are installed** to ensure the update is fully applied and the system is in a consistent state.

## Post-Reboot Verification

Once the system has been rebooted, verify that the patches have been properly installed and applied using the following PowerShell command:

```powershell
Get-HotFix
```

## Final output
<img width="1718" alt="Screenshot 2025-06-30 at 12 57 59 PM" src="https://github.ibm.com/roja/concert-workflows/assets/481473/13d57586-f294-4473-9dc5-7d0ecc11df81">






# Automated KB Installation for Windows

This workflow automates the installation of Windows security updates (KBs) using Ansible.  
It is a sub-component of the overall **Windows Patching for Air-Gapped Servers** process.

---

## Overview

- This workflow is designed to install specific KBs on a target Windows VM.
- It uses the **same Mirror VM** used in the main patching setup to download and store KB files.
- If the mirror VM is not already set up, refer to the [Windows Patching on Air-Gapped Servers](#) README for configuration details.

---

## Authentication

Follow the instructions in the main patching [Windows Patching on Air-Gapped Servers](#) README to generate an RSA key pair

---

## Ansible Inventory Configuration

Use the following structure to define your inventory for Ansible:

```ini
[windows]
0.0.0.0  # Public IP of the target Windows VM

[windows:vars]
ansible_user=<user_name>
ansible_password=<password>
ansible_connection=winrm
ansible_port=<winrm_port>           # 5985 for HTTP, 5986 for HTTPS
ansible_winrm_transport=ntlm
ansible_winrm_server_cert_validation=ignore
```

---

## Required Inputs

- **CVEs**  
  List of CVE numbers for which corresponding KBs need to be downloaded and stored.

- **folder_path_to_download_kbs**  
  Full path on the mirror VM where the KB files will be stored (e.g., `C:\KBs\Download`).

  <img width="1726" alt="Screenshot 2025-06-25 at 1 19 21 AM" src="https://github.ibm.com/roja/concert-workflows/assets/481473/c9dc0f0c-abab-4066-8ac9-e7de297914da">


## Run Workflow
Ensure all authentication configurations and required inputs are provided before running the workflow.

## Verification
- For each KB, a **separate subfolder** should be created under the specified `folder_path_to_download_kbs`.
- Each subfolder should contain the relevant KB files downloaded for that particular update.

Verify the contents manually on the mirror VM to ensure successful execution.
<img width="866" alt="Screenshot 2025-06-25 at 1 40 52 AM" src="https://github.ibm.com/roja/concert-workflows/assets/481473/636d1b1e-103a-402b-b960-5a3dcc03b937">


## Final output
<img width="1718" alt="Screenshot 2025-06-25 at 1 42 22 AM" src="https://github.ibm.com/roja/concert-workflows/assets/481473/cbcba614-1726-4d89-99b8-14c3dd1fdcd7">




# IBM Power Autoremediation Workflows

## Overview
- These workflows are created to integrate IBM Power with Concert
- It will helps to bring Power inventory and Power related vulnerabilities to Concert. 
- It also helps to Patch the Power systems based on the actions created in Concert.

## Pre-requesites
- Generate `C_API_KEY` from Concert dashboard
- 

## Authentications

- ###  IBM API Authentication
  - Select API Key from Service 
  - Header Name = `Authentication` and API Key value = `C_API_KEY <API_KEY>`
- ###  Power HMC Authentication
  - This is to provide HMC User ID and password to authenticae HMC APIs.
  - Choose Config Data from Service
  - Format
  ```
  {
    "<hmc_ip_1>": {
        "username": "<hmc user id 1>",
        "password": "<hmc password 1>"
    },
    "<hmc_ip_2>": {
        "username": "<hmc user id 2>",
        "password": "<hmc password 2>"
    },
    "<hmc_ip_2>": {
        "username": "<hmc user id 3>",
        "password": "<hmc password 3>"
    }
  }
  ```
- ### Concert Configurations
  - This is to provide info required to call Concert APIs
  - Choose Config Data from Service
  - Format
  ```
  {
    "host": "<Concert_host_name>",
    "port": "<Concert_port_number>",
    "instance_id": "<concert_instance_id>",
    "content_type": "<content_type>",
    "watson_model_id": "<watsonx_model_id>",
    "username": "<Concert_Username>",
    "password": "<Concert_Password>"
  }
  ```
  - Preferred mwatson_model_id is ibm/granite-3-2-8b-instruct

- ### ServiceNow Authentication
  - Service now is the tool we use for external approval
  - Choose ServiceNow from the Service
  - Provide Host, Username and Password

## Setup and Run workflows

> Import Power_Inventory_Workflow, Power_Advisory_Workflow, Power_Patch_Scheduler and Create_Change_Request_For_Remediation_Action workflows from IBM Automation Library. <br>
> We Suggest to not touch workflows, instead configure everything using Workflow Jobs. 

- ### Inventory Job
  - This will helps to fetch the Power Inventory to Concert database.
  - Create a job and Select <b>Power_Inventory_Workflow</b>
  - Suggested value for Repeats field is Hourly. 
  - Disable the <b>Run with Default input values</b> option
  - Provide the corresponding AuthKey values against each input fields.
  <img width="2560" alt="image" src="https://github.ibm.com/roja/concert-workflows/assets/488966/c874631f-6645-4140-8cff-d1483e319b40">


- ### Advisory Job
  - This will helps to fetch the Vulnerabilities information to Concert database.
  - Create a job and Select <b>Power_Advisory_Workflow</b>
  - Suggested value for Repeats field is Daily. 
  - Disable the <b>Run with Default input values</b> option
  - Provide the corresponding AuthKey values against each input fields.
  <img width="2560" alt="image" src="https://github.ibm.com/roja/concert-workflows/assets/488966/8446b9e5-e4a2-4d83-93c3-84dcf8c73a32">


- ### Create Change Request Job
  - This will helps to create change request in Service Now if the Approval tool is External.
  - Create a job and Select <b>Create_Change_Request_For_Remediation_Action </b>
  - Suggested value for Repeats field is Every 2 mins. To do that, Choose Repeats as <b> Advanced settings </b> and in the <b>Minutes</b> as <b>*/2</b>
  - Disable the <b>Run with Default input values</b> option
  - sm_host is the host url of Service Now portal.
  - Provide values against each input fields.
  <img width="2560" alt="image" src="https://github.ibm.com/roja/concert-workflows/assets/488966/ebc5718e-4ce9-4cb4-80a3-89b0e1f510cc">


- ### Scheduler Job
  - This will helsp to schedule different Patch jobs based on the actions created.
  - Create a job and Select <b>Power_Patch_Scheduler </b>
  - Suggested to repeat the job at every 2 minutes
  - Disable the <b>Run with Default input values</b> option
  - Provide values against each input fields.
  - VIOSPatchWorkflowURN, HMCPatchWorkflowURN, FWPatchWorkflowURN are the workflow URNs of VIOS, HMC and FW Patch workflows. 

      Eg:- "ibmconcert/User/Power_Patch_Scheduler_Helpers/Power_VIOS_Patch_Workflow"
 <img width="2560" alt="image" src="https://github.ibm.com/roja/concert-workflows/assets/488966/be16e23f-f230-4972-8ed4-d35c80e3486f">
 


